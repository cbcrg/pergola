.. _quick_start: 

Quick start
===========

If you have to start using Pergola in some easy steps follow this guide.

.. note::

  This quick start guide assumes Pergola has been previously installed, if this is not the case follow instructions in
  :ref:`installation` section.

-------------------------
Get your data
-------------------------

.. _input-data:

.. *****************
.. Zenodo data
.. *****************

A data set containing motion behavior from *C.elegans* data set is available on `Zenodo <https://zenodo.org/record/582343/files/celegans_unc16_N2.tar.gz>`_.
Two download all the files inside a folder name data you can follow these commands:

.. code-block:: bash

  mkdir data
  wget -O- https://zenodo.org/record/582343/files/celegans_unc16_N2.tar.gz | tar xz -C data

.. note::
  
  Explain in what consist the data set
  
********************
Declare equivalence
********************

Pergola needs you to set the mappings between the information represented in your behavioral file in order to understand each piece of information inside your
file, see :ref:`mapping-file` and :ref:`pergola-ontology` for a deeper description. You can download the mapping file for this example `here <https://gist.githubusercontent.com/JoseEspinosa/b49900521c53123108c82832da8d063c/raw/a9f05ec8f67dc19b665f788bc7b986876d1b6320/worm_speed2pergola.txt>`_.

.. code-block:: bash

  wget -O- https://gist.githubusercontent.com/JoseEspinosa/b49900521c53123108c82832da8d063c/raw/a9f05ec8f67dc19b665f788bc7b986876d1b6320/worm_speed2pergola.txt > ./data/worm_speed2pergola.txt
    
********************
Pull Pergola image
********************

You can obtain last Pergola version from `Pergola Docker Hub repository <https://hub.docker.com/u/pergola/>`_.

.. code-block:: bash

  docker pull pergola/pergola:latest 
    
First we will launch Pergola image mounting the files we need into the container by typing:

.. code-block:: bash
  
  docker run --rm -it -v /data:/container_data -w /container_data pergola/pergola bash

.. note::

  If you want to install Pergola on your system instead, refer to :ref:`installation` documentation section.
    
************
Run Pergola
************

You can know process the downloaded with Pergola using the following command:

.. code-block:: bash

  pergola -i ./data/*.csv -m ./data/worm_speed2pergola.txt -f bedGraph -w 1 -min 0 -max 29000

The resultings files can be uploaded on a desktop browser for its visualization as explained below.

***************
Visualize data
***************

We choose the `Integrative Genomics Viewer <http://software.broadinstitute.org/software/igv/>`_ for visualizing the data. IGV can be downloaded from 
`here <http://software.broadinstitute.org/software/igv/download>`_. 

After launching IGV, first you have to create a genome file. Go to **Genomes** menu and click on "Create .genome File..." 
Data can be visualize using a heatmap.

.. image:: ./images/menu_create_genome.png

On the menu that pops up load the fasta file generated by Pergola and click on OK.

.. image:: ./images/create_genome.png

Now you can render all BedGraph files generated before by going to **File** menu and click on "Load from File..."

.. image:: ./images/load_files.png

.. note:: 
  Stack the tracks corresponding to each group, in this manner differences will become easier to identify
  
Finally to obtain a heatmap of the tracks it is necessary to set some options:

* To visualize all the tracks in the screen go to **Tracks** and click on "Fit Data to Window"

.. image:: ./images/load_files.png

* Now select all tracks by clicking on their names and right click with the mouse, as a result a menu will pop up. On this menu check "Heatmap" under **Type of Graph** menu and "None" under **Windowing Function**. 

.. image:: ./images/select_heatmap.png

* To display the differences between the tracks, adjust heatmap settings as shown in the snapshot below.

.. image:: ./images/heatmap_menu.png

* The resulting rendering shows how overall the speeds of UNC-16 (uncoordinated strain), tracks below, are lower depicting a deficient moving behavior when compared to control (N2) strain on top.

.. image:: ./images/final_snapshot_heatmap.png




